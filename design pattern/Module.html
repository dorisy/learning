<!doctype html>
<html>
	<head>
		 <meta charset="utf-8">
		 <title>MODULE</title>
		 <style type="text/css">
		 	th,td{
		 		border: 1px solid #999;
		 		text-align: center;
		 	}
		 </style>
	</head>
	<body>
		<table style="border-collapse:collapse;border:1px solid #333;">
			<tbody>
				<tr><th>名称</th><th>单价(￥/500g)</th><th>操作</th></tr>
				<tr><td>小白菜</td><td>2.0</td><td><button class="add-item" value="添加到购物车">添加到购物车</button></td></tr>
				<tr><td>大白菜</td><td>1.0</td><td><button class="add-item" value="添加到购物车">添加到购物车</button></td></tr>
				<tr><td>苦瓜</td><td>2.5</td><td><button class="add-item" value="添加到购物车">添加到购物车</button></td></tr>
			</tbody>
		</table>
		<button id="getTotal">结算</button>
		<p id='total'>What is the difference bettween singleton-pattern and module-pattern</p>
		<script type="text/javascript">
			var basketModule=(function(){
				var basket=[];
				return {
					addItem:function(values){
						basket.push(values);
					},
					getItemCount:function(){
						return basket.length;
					},
					getTotal:function(){
						var itemCount=this.getItemCount(),
							total=0;
						while(itemCount--){
							total+=basket[itemCount].price;
						}
						return total;
					}
				}
			})();
			var addBtn=document.getElementsByTagName('button');
			for(var i=0,len=addBtn.length;i<len;i++){
				addBtn[i].onclick=function(){
				var closest=this.parentNode.parentNode,
					name=closest.firstChild.innerHTML,
					price=parseFloat(this.parentNode.previousSibling.innerHTML);
				basketModule.addItem({
					"name":name,
					"price":price
				})
			}
			}
			
			document.getElementById('getTotal').onclick=function(){
				var total=basketModule.getTotal();
				document.getElementById('total').innerHTML=total+'元';
			}

		</script>
	</body>
</html>