<!doctype html>
<html>
	<head>
		<meta charset="utf-8"/>
		<style type="text/css">
			li{
				list-style: none;
				font-family: "微软雅黑";
			}
		</style>
	</head>
	<body>
		<button id="send">开始聊天</button>
		<ul id="message">

		</ul>
		<script type="text/javascript">
		if(typeof(Worker)!=="undefined"){
			var myWorker = new Worker("my_task.js");
			myWorker.onmessage = function (oEvent) {//接收线程发过来的消息
			  console.log("Worker said : " + oEvent.data);
			};
			document.getElementById("send").onclick=function(){
				var msg=prompt("说点什么")||"你好！";
				myWorker.postMessage(msg);//向另外的线程发送消息
				var li=document.createElement("li");
				li.innerHTML="他说："+msg;
				document.getElementById("message").appendChild(li);
				myWorker.onmessage=function(data){
					var li1=document.createElement("li");
					li1.innerHTML="她回复："+data.data.msg+"  "+data.data.time;
					document.getElementById("message").appendChild(li1);
				}
			}
		}else{
			alert("不支持web worker ");
		}
		</script>
	</body>
</html>
